<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="zj.dao.AttendanceStatistics" >

    <!-- 外出 -->
    <select id="selectout" resultType="map">
        select * from hr_go_out where sta_staff_id=#{staffId}
    </select>
    <!--  出差 -->
    <select id="selecttra" resultType="map">
        select * from travel where sta_staff_id=#{staffId}
    </select>
    <!-- 请假 -->
    <select id="selectvoc" resultType="map">
        select * from vocation where sta_staff_id=#{staffId}
    </select>
    <!-- 上下班登记 -->
    <select id="selectreg" resultType="map">
        select * from work_register where staff_id=#{staffId}
    </select>
    
    

  	<!-- 考勤统计 -->
	<select id="selectas" resultType="map">
		 select i.staff_id,i.STAFF_NAME,COUNT(t.travel_id) ct,count(v.vocation_id) cv,count(r.work_id) cr,count(o.out_id) co,
		 t.*,v.*,r.*,o.*,sum(late) sl,SUM(rest) sr,SUM(absenteeism) sa,sum(work_unregistered) su,SUM(work_off) so
         from staff_info i 
         left JOIN travel t on i.staff_id=t.STAFF_ID
         left join vocation v on i.staff_id=v.STAFF_ID
         left join work_register r on i.staff_id=r.staff_id
         left join hr_go_out o on i.staff_id=o.STAFF_ID
         group by i.staff_id,i.staff_name 
         order by i.staff_id asc
	</select>
</mapper>